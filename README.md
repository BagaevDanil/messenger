# Клиент-серверное приложение Messenger

## Описание
В ходе проекта требовалось написать мессенджер с использованием языка С++. Необходимо было реализовать и клиент, и сервер. Ожидаемая топология подключения клиентов - звезда (один сервер, который знает всё и обо всех клиентах).
Реализованный набор функциональностей:
* Авторизация
* Регистрация новых пользователей
* Отправка и прием текстовых сообщений
* Хранение истории сообщений
* Вход с нескольких устройств с синхронизацией сообщений
* Объмен любыми файлами

## Сборка
Не получилось до конца настроить conan, тк официальная поддержка qt on conan прекращена в конце 2022. Поэтому сборка возможна только с использованием Qt Creator.
В проекте используются только библиотеки и модули из Qt и STL.

## Серверная часть
Сервер позволяет принимать входящие TCP-соединения и обраюатывать запросы клиентов. 
Во время запуска сервер выставляется порт и включается прослушивание по адресам, инциализирует подключение к базе данных и выгружает от туда необходимые данные.

Сервер принимает запросы 8 видов:
  * Авторизация - проверка существования пользователя в БД.
  * Регистрация - добавление нового пользователя в БД.
  * Текстовое сообщение - сохранение сообщения в БД и рассылка всем подключенным пользователям.
  * Проверка подключения - запрос для проверки стабильности подключения.
  * Итория сообщений - отправка набора из 10 сообщений с требуемого индекса. 
  * Отправка файла клиенту - отправка файла с сервера пользователю.
  * Скачивание файла от клиента - скачивание и сохранение нового файла от пользователя.
  * Подписка на рассылку новых сообщений - добавить сокет в список подключенных клиентов.

Работа с базой данных осуществляется через SQL запросы. БД используется для авторизации и регистрации пользователей, подгрузку истории и сохранение новых сообщений, загрузка новых и скачивание существующих файлов.
Отправка сообщений и файлов происходит через сокеты. При отправке файлов между клиентом и сервером, с целью возможности передачи больших данных, включается режим скачивания и файлы передаются/примаются по частям.

## Клиентская часть
Приложение с графическим интерфейсом на QT. Использует сокеты для подключения к серверу.
Состоит из двух экранов: 
* Авторизаци
* Чат
 
Экран авторизации позволяет выполнить вход и регистрацию пользователя используя интерфейс. Данные проверяются на корректность, затем отправляется соотвествующий запрос на сервер и ожидается ответ.
Экран с чатом позволяет получать и отправлять сообщения. Сообщения могут быть с тестом или файлом, а также указан создатель сообщения и время создания. Прикрепленные к сообщению файлы можно скачать на компьютер. 
Для взаимодействия с сервором создается 2 сокета, первый для отправки и получения текстовых сообщений, а второй для отправки и скачивания файлов. Это сделано, чтобы пользователь мог продолжать использовать чат во время загрузки больших файлов. Также есть возможность загрузить историю сообщений.
  
## База данных:
Для хранения и обрабатки информации в структурированном виде используется встроеная реляционная база данных SQLite.
Таблицы в БД:
* Users - хранит информацию о пользователях в системе (логин, пароль).
* Messenges - хранит историю сообщений (id, логин создателя, тест сообщения, время создания, тип сообщения, id прикрепленного файла)
* Files - хранит отправленные пользователями файлы (id файла, название и расширение файла, файл в формате массива байтов)
